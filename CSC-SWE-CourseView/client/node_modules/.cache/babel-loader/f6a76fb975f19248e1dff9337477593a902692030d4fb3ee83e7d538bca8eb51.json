{"ast":null,"code":"import Cookies from 'js-cookie';\n// import { JWE, JWK } from 'jose'; //error libarary\n\n{/*\r\n \n Mission encrypted/decrypted data\r\n Package Struct:\r\n req_encrypted.body = {\r\n    key: partOfKey,\r\n    data: encryptedData ={\r\n        userID: userID,\r\n        action: action,\r\n        entry: data\r\n    },\r\n    image: image\r\n }\r\n Behavior:\r\n use tokenS key\r\n */}\nexport default class MySecurity {\n  static getUserToken() {\n    {/* connect the databse at server, client use cookie or location storage*/}\n    const accessToken = Cookies.get('access_token');\n    if (accessToken === null) return \"createNewAccount\";\n    return accessToken ? \"\" : accessToken;\n  }\n  static encryptedData(jsonData) {\n    /*        \r\n    // Tempary disable security\r\n    let secretKey = this.getUserToken();\r\n    // Create a JSON Web Key (JWK) from the secret key\r\n    const jwk = JWK.asKey({ k: secretKey, alg: 'dir' });\r\n      // Encrypt the JSON data using JWE\r\n    JWE.createEncrypt({ format: 'compact', contentAlg: 'A256GCM' }, jwk)\r\n        .update(JSON.stringify(jsonData), 'utf8')\r\n        .final()\r\n        .then((result) => {\r\n            return result;\r\n        })\r\n        .catch((error) => console.error('Encryption Error:', error));\r\n    return null;\r\n    */\n    return jsonData;\n  }\n  static encryptedPackage(action, data, selectedImage) {\n    /* \r\n    // temporary disable security\r\n    let partOfKey = \"createNewAccount\"\r\n    let secretKey = this.getUserToken();\r\n    //console.log(secretKey);\r\n    \r\n    if (secretKey !== null && secretKey !== \"createNewAccount\") {\r\n        partOfKey = secretKey.substring(0, Math.floor(Math.random() * (20 - 10 + 1) + 10));\r\n    }\r\n    \r\n    let jsonData = {\r\n        userID: Cookies.get(\"userID\"),\r\n        action: action,\r\n        entry: data\r\n    };\r\n    const encrytedD = this.encryptedData(jsonData);\r\n    \n    let formData = new FormData();\r\n    if (selectedImage) {\r\n        formData.append('image', selectedImage);\r\n    }\r\n    formData.append('key', partOfKey);\r\n    formData.append('data', encrytedD);      \r\n    */\n\n    let jsondata = {\n      userID: Cookies.get(\"userID\"),\n      action: action,\n      entry: data\n    };\n    let formData = new FormData();\n    formData.append('key', \"\");\n    formData.append('data', JSON.stringify(jsondata));\n    if (selectedImage !== null && selectedImage !== undefined) {\n      formData.append('picture', selectedImage);\n    }\n    return formData;\n  }\n  static decryptedData(jsonData) {\n    /*\r\n    // Tempary disable security\r\n    let secretKey = this.getUserToken();  \r\n    // try Decrypt the encrypted data using JWE\r\n    const jwk = JWK.asKey({ k: secretKey, alg: 'dir' });\r\n    JWE.createDecrypt(jwk)\r\n        .decrypt(jsonData, 'utf8')\r\n        .then((result) => {\r\n            const decryptedData = JSON.parse(result.payload.toString('utf8'));             \r\n            return decryptedData;\r\n        })\r\n        .catch((error) => console.error('Decryption Error:', error));\r\n    return null;\r\n    */\n    return jsonData;\n  }\n}","map":{"version":3,"names":["Cookies","MySecurity","getUserToken","accessToken","get","encryptedData","jsonData","encryptedPackage","action","data","selectedImage","jsondata","userID","entry","formData","FormData","append","JSON","stringify","undefined","decryptedData"],"sources":["C:/Users/islay/Documents/Local_Repo/CSC4350_SWE/CSC-SWE-CourseView/client/src/api/mySecurity.js"],"sourcesContent":["\r\nimport Cookies from 'js-cookie';\r\n// import { JWE, JWK } from 'jose'; //error libarary\r\n\r\n{/*\r\n\r\nMission encrypted/decrypted data\r\nPackage Struct:\r\nreq_encrypted.body = {\r\n    key: partOfKey,\r\n    data: encryptedData ={\r\n        userID: userID,\r\n        action: action,\r\n        entry: data\r\n    },\r\n    image: image\r\n}\r\nBehavior:\r\nuse tokenS key\r\n*/}\r\nexport default class MySecurity {\r\n    static getUserToken() {\r\n        {/* connect the databse at server, client use cookie or location storage*/ }\r\n        const accessToken = Cookies.get('access_token');\r\n        if (accessToken === null) return \"createNewAccount\";\r\n        return accessToken?\"\":accessToken;\r\n    }\r\n    static encryptedData(jsonData) {\r\n        /*        \r\n        // Tempary disable security\r\n        let secretKey = this.getUserToken();\r\n        // Create a JSON Web Key (JWK) from the secret key\r\n        const jwk = JWK.asKey({ k: secretKey, alg: 'dir' });\r\n\r\n        // Encrypt the JSON data using JWE\r\n        JWE.createEncrypt({ format: 'compact', contentAlg: 'A256GCM' }, jwk)\r\n            .update(JSON.stringify(jsonData), 'utf8')\r\n            .final()\r\n            .then((result) => {\r\n                return result;\r\n            })\r\n            .catch((error) => console.error('Encryption Error:', error));\r\n        return null;\r\n        */\r\n        return jsonData;\r\n    }\r\n    static encryptedPackage(action, data, selectedImage) {\r\n        /* \r\n        // temporary disable security\r\n        let partOfKey = \"createNewAccount\"\r\n        let secretKey = this.getUserToken();\r\n        //console.log(secretKey);\r\n        \r\n        if (secretKey !== null && secretKey !== \"createNewAccount\") {\r\n            partOfKey = secretKey.substring(0, Math.floor(Math.random() * (20 - 10 + 1) + 10));\r\n        }\r\n        \r\n        let jsonData = {\r\n            userID: Cookies.get(\"userID\"),\r\n            action: action,\r\n            entry: data\r\n        };\r\n        const encrytedD = this.encryptedData(jsonData);\r\n       \r\n        let formData = new FormData();\r\n        if (selectedImage) {\r\n            formData.append('image', selectedImage);\r\n        }\r\n        formData.append('key', partOfKey);\r\n        formData.append('data', encrytedD);      \r\n        */\r\n        \r\n        let jsondata = {\r\n            userID: Cookies.get(\"userID\"),\r\n            action: action,\r\n            entry: data\r\n        };\r\n        let formData = new FormData();        \r\n        formData.append('key', \"\");\r\n        formData.append('data', JSON.stringify(jsondata));\r\n        if (selectedImage !==null && selectedImage !== undefined) {\r\n            formData.append('picture', selectedImage);\r\n        }\r\n        return formData;\r\n    }\r\n    static decryptedData(jsonData) {\r\n        /*\r\n        // Tempary disable security\r\n        let secretKey = this.getUserToken();  \r\n        // try Decrypt the encrypted data using JWE\r\n        const jwk = JWK.asKey({ k: secretKey, alg: 'dir' });\r\n        JWE.createDecrypt(jwk)\r\n            .decrypt(jsonData, 'utf8')\r\n            .then((result) => {\r\n                const decryptedData = JSON.parse(result.payload.toString('utf8'));             \r\n                return decryptedData;\r\n            })\r\n            .catch((error) => console.error('Decryption Error:', error));\r\n        return null;\r\n        */\r\n        return jsonData;\r\n    }\r\n}"],"mappings":"AACA,OAAOA,OAAO,MAAM,WAAW;AAC/B;;AAEA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAfC;AAgBD,eAAe,MAAMC,UAAU,CAAC;EAC5B,OAAOC,YAAYA,CAAA,EAAG;IAClB,CAAC;IACD,MAAMC,WAAW,GAAGH,OAAO,CAACI,GAAG,CAAC,cAAc,CAAC;IAC/C,IAAID,WAAW,KAAK,IAAI,EAAE,OAAO,kBAAkB;IACnD,OAAOA,WAAW,GAAC,EAAE,GAACA,WAAW;EACrC;EACA,OAAOE,aAAaA,CAACC,QAAQ,EAAE;IAC3B;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IAEQ,OAAOA,QAAQ;EACnB;EACA,OAAOC,gBAAgBA,CAACC,MAAM,EAAEC,IAAI,EAAEC,aAAa,EAAE;IACjD;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAEQ,IAAIC,QAAQ,GAAG;MACXC,MAAM,EAAEZ,OAAO,CAACI,GAAG,CAAC,QAAQ,CAAC;MAC7BI,MAAM,EAAEA,MAAM;MACdK,KAAK,EAAEJ;IACX,CAAC;IACD,IAAIK,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;IAC7BD,QAAQ,CAACE,MAAM,CAAC,KAAK,EAAE,EAAE,CAAC;IAC1BF,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACP,QAAQ,CAAC,CAAC;IACjD,IAAID,aAAa,KAAI,IAAI,IAAIA,aAAa,KAAKS,SAAS,EAAE;MACtDL,QAAQ,CAACE,MAAM,CAAC,SAAS,EAAEN,aAAa,CAAC;IAC7C;IACA,OAAOI,QAAQ;EACnB;EACA,OAAOM,aAAaA,CAACd,QAAQ,EAAE;IAC3B;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACQ,OAAOA,QAAQ;EACnB;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}